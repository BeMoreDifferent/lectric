  /*!
   * Lectric v0.3.1
   * http://github.com/mckinney/lectric
   *
   * Copyright 2011, McKinney
   * Licensed under the MIT license.
   * http://github.com/mckinney/lectric/blob/master/LICENSE
   *
   * Author: Brett C. Buddin
   */
(function(g){isWebkit=!!navigator.userAgent.toLowerCase().match(/applewebkit/i);var l=false;try{document.createEvent("TouchEvent");l=true}catch(q){}var m=function(a,b){var c=a.css(b);return c!==undefined?parseInt(c.replace("px",""),10):0},k=function(a,b){if(a&&a.hasOwnProperty("x")&&a.hasOwnProperty("y")){a=a.x;b=a.y}this.x=a;this.y=b};k.prototype={difference:function(a){return new k(a.x-this.x,a.y-this.y)}};Lectric.Position=k;var d=function(){};d.prototype.init=function(a,b){this.opts=jQuery.extend({reverse:false,
next:undefined,previous:undefined,itemWrapperClassName:"items",itemClassName:"item",limitLeft:false,limitRight:false,animateDuration:400,hooks:{}},b);this.position=new k(0,0);this.startPosition=new k(this.position);this.lastPosition=new k(this.position);var c=$("<div/>",{className:this.opts.itemWrapperClassName});c.css("width","1000000px");var h="."+this.opts.itemClassName,j="."+this.opts.itemWrapperClassName;$(a).css("overflow","hidden");$(a).find(h).css("float","left").wrapAll(c);this.element=$(a).find(j);
this.element.itemSelector=h;this.element.itemWrapperSelector=j;var i=this;c=l?"touchstart":"click";$(this.opts.next).bind(c,function(e){e.preventDefault();e=i.page();i.to(e+1);i.element.trigger("nextButton.lectric")});$(this.opts.previous).bind(c,function(e){e.preventDefault();e=i.page();i.to(e-1);i.element.trigger("previousButton.lectric")});if(l){$(this.opts.next).click(function(e){e.preventDefault()});$(this.opts.previous).click(function(e){e.preventDefault()})}$.each(this.opts.hooks,function(e,
n){$.isArray(n)?$.each(n,function(o){i.subscribe(e,o)}):i.subscribe(e,n)});this.element.trigger("init.lectric")};d.prototype.update=function(a){a=jQuery.extend({animate:true,triggerMove:true},a);var b=this,c=function(){b.element.trigger("animationEnd.lectric");$(this).dequeue()};a.animate?this.element.animate({"margin-left":this.position.x+"px"},this.opts.animateDuration).queue(c):this.element.css({"margin-left":this.position.x+"px"}).queue(c);a.triggerMove&&this.element.trigger("move.lectric")};
d.prototype.subscribe=function(a,b){var c=this,h=function(j){j.target==c.element[0]&&b(c,j)};this.element.bind(a+".lectric",h);return h};d.prototype.unsubscribe=function(a,b){typeof b!==undefined&&$.isFunction(b)?this.element.unbind(a+".lectric",b):this.element.unbind(a+".lectric")};d.prototype.page=function(){return Math.abs(Math.round(this.position.x/this.itemWidth()))};d.prototype.to=function(a){var b=this.position.x;this.position.x=this.limitXBounds(this.xForPage(a));this.position.x!==b&&this.update()};
d.prototype.toItem=function(a){var b=this.element.find(this.element.itemSelector),c,h=b.length;for(c=0;c<h;c++)$(b[c])[0]==a[0]&&this.to(c)};d.prototype.xForPage=function(a){return(this.opts.reverse?1:-1)*a*this.itemWidth()};d.prototype.itemWidth=function(){var a=this.element.find(this.element.itemSelector).eq(0),b=m(a,"paddingRight")+m(a,"paddingLeft");return m(a,"marginRight")+b+a.width()};d.prototype.itemCount=function(){return this.element.find(this.element.itemSelector).size()};d.prototype.limitXBounds=
function(a){var b=this.itemWidth(),c=this.itemCount();c=b*c;if(this.opts.reverse){a=a>c-b?c-b:a;a=a<0?0:a}else{a=a<-c+b?-c+b:a;a=a>0?0:a}if(this.position.x-a>0&&this.opts.limitRight||this.position.x-a<0&&this.opts.limitRight)a=this.position.x;return a};Lectric.BaseSlider=d;var f=function(){};f.prototype=new d;f.superobject=d.prototype;f.prototype.init=function(a,b){f.superobject.init.call(this,a,b);this.opts=$.extend({tossFunction:function(c,h,j){return c+h*100/j}},this.opts);this.element.parent().addClass("lectric-slider-touch");
this.gesturing=false;$(a)[0].addEventListener("touchstart",this,false);$(a)[0].addEventListener("webkitTransitionEnd",this,false)};f.prototype.handleEvent=function(a){p[a.type].call(this,a)};f.prototype.update=function(a){a=jQuery.extend({animate:true,triggerMove:true},a);a.animate&&this.decayOn();this.element.css({"-webkit-transform":"translate3d("+this.position.x+"px, 0, 0)"});a.triggerMove&&this.element.trigger("move.lectric")};f.prototype.decayOff=function(){this.element.css({"-webkit-transition-duration":"0s"});
this.element.css({"-webkit-transition-property":"none"})};f.prototype.decayOn=function(){this.element.css({"-webkit-transition-duration":this.opts.animateDuration/1E3+"s"});this.element.css({"-webkit-transition-property":"-webkit-transform"})};var p={click:function(a){this.moved&&a.preventDefault();this.element[0].removeEventListener("click",this,false);return false},touchstart:function(a){this.currentTarget=a.currentTarget;this.startPosition.x=a.touches[0].pageX-this.position.x;this.startPosition.y=
a.touches[0].pageY-this.position.y;this.moved=false;g.addEventListener("gesturestart",this,false);g.addEventListener("gestureend",this,false);g.addEventListener("touchmove",this,false);g.addEventListener("touchend",this,false);this.element[0].addEventListener("click",this,false);this.decayOff();this.element.trigger("start.lectric")},touchmove:function(a){if(this.gesturing)return false;if(!this.moved){Math.abs(a.touches[0].pageY-this.startPosition.y)<15&&a.preventDefault();this.element.trigger("firstMove.lectric")}this.moved=
true;this.lastPosition.x=this.position.x;this.lastPosition.y=this.position.y;this.lastMoveTime=new Date;this.position.x=this.limitXBounds(a.touches[0].pageX-this.startPosition.x);this.update({animate:false})},touchend:function(){g.removeEventListener("gesturestart",this,false);g.removeEventListener("gestureend",this,false);g.removeEventListener("touchmove",this,false);g.removeEventListener("touchend",this,false);if(this.moved){this.limitXBounds(this.opts.tossFunction(this.position.x,this.position.x-
this.lastPosition.x,new Date-this.lastMoveTime+1));var a=this.itemWidth();this.position.x=Math.round(this.position.x/a)*a;this.update();this.element.trigger("end.lectric")}else this.element.trigger("endNoMove.lectric");this.currentTarget=undefined},gesturestart:function(){this.gesturing=true},gestureend:function(){this.gesturing=false},webkitTransitionEnd:function(){this.element.trigger("animationEnd.lectric")}};Lectric.TouchSlider=f;Lectric.Slider=function(){return l&&isWebkit?new f:new d};g.Lectric=
Lectric})(window);
