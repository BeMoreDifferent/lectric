  /*!
   * Lectric v0.1
   * http://github.com/mckinney/lectric
   *
   * Copyright 2010, McKinney
   * Licensed under the MIT license.
   * http://github.com/mckinney/lectric/blob/master/LICENSE
   *
   * Author: Brett C. Buddin
   */
(function(g){var h={},d={},j=navigator.userAgent.toLowerCase();d.isWebkit=j.indexOf("applewebkit/")>-1;try{document.createEvent("TouchEvent");d.supportsTouch=true}catch(k){d.supportsTouch=false}h.Browser=d;d=function(){};d.prototype.init=function(a,b){this.opts=jQuery.extend({next:undefined,previous:undefined,limitLeft:false,limitRight:false,init:undefined},b);this.currentY=this.currentX=0;var f=$(a);f.find(".item").wrapAll('<div class="items">');f.css("overflow","hidden");this.element=f.find(".items");
this.element.css("width","1000000px");this.element.find(".item").css("float","left");this.structure=this.structure(this.element);var c=this;this.opts.next&&$(this.opts.next).bind("click",function(){var i=c.currentX;c.currentX=c.limitXBounds(c.nextPageX(c.currentX));c.currentX!==i&&c.update();return false});this.opts.previous&&$(this.opts.previous).bind("click",function(){var i=c.currentX;c.currentX=c.limitXBounds(c.previousPageX(c.currentX));c.currentX!==i&&c.update();return false});this.opts.init!==
undefined&&this.opts.init(this)};d.prototype.update=function(a){a=jQuery.extend({animate:true,triggerMove:true},a||{});var b=function(){this.element.trigger("lectric.animationEnd");$(this).dequeue()};a.animate?this.element.animate({"margin-left":this.currentX+"px"}).queue(b):this.element.css({"margin-left":this.currentX+"px"}).queue(b);a.triggerMove&&this.element.trigger("lectric.move")};d.prototype.subscribe=function(a,b){var f=this;return this.element.bind("lectric."+a,function(c){c.target==f.element[0]&&
b(f)})};d.prototype.structure=function(a){var b={},f=function(){return a.find(".item").eq(0)};b.itemCount=function(){return a.find(".item").size()};b.itemHeight=function(){return parseInt(f().height())};b.itemSpacing=function(){var c=f().css("marginRight");return c!==undefined?parseInt(c.replace("px","")):0};b.itemWidth=function(){return b.itemSpacing()+parseInt(f().width())};return b};d.prototype.page=function(a){return Math.abs(Math.round(a/this.structure.itemWidth()))};d.prototype.nearestPageX=
function(a){return Math.round(a/this.structure.itemWidth())*this.structure.itemWidth()};d.prototype.pageX=function(a){return(this.opts.reverse?1:-1)*a*this.structure.itemWidth()};d.prototype.nextPageX=function(a){if(this.page(a)+1<=this.structure.itemCount()-1)a-=this.structure.itemWidth();return a};d.prototype.previousPageX=function(a){if(this.page(a)>=0)a+=this.structure.itemWidth();return a};d.prototype.limitXBounds=function(a){var b=this.structure.itemWidth()*this.structure.itemCount();if(this.opts.reverse){a=
a>b-this.structure.itemWidth()?b-this.structure.itemWidth():a;a=a<0?0:a}else{a=a<-b+this.structure.itemWidth()?-b+this.structure.itemWidth():a;a=a>0?0:a}if(this.currentX-a>0&&this.opts.limitRight||this.currentX-a<0&&this.opts.limitLeft)a=this.currentX;return a};var e=function(){};e.prototype=new d;e.superobject=d.prototype;e.prototype.init=function(a,b,f){e.superobject.init.call(this,a,b,f);this.element.parent().addClass("lectric-slider-touch");this.gesturing=false;a=$(a);a[0].addEventListener("touchstart",
this,false);a[0].addEventListener("webkitTransitionEnd",this,false)};e.prototype.update=function(a){a=jQuery.extend({animate:true,triggerMove:true},a||{});a.animate&&this.decayOn();this.element.css({"-webkit-transform":"translate3d("+this.currentX+"px, 0, 0)"});a.triggerMove&&this.element.trigger("lectric.move")};e.prototype.handleEvent=function(a){this[a.type](a)};e.prototype.click=function(a){this.moved&&a.preventDefault();this.element[0].removeEventListener("click",this,false);return false};e.prototype.touchstart=
function(a){this.currentTarget=a.currentTarget;this.startX=a.touches[0].pageX-this.currentX;this.startY=a.touches[0].pageY-this.currentY;this.moved=false;g.addEventListener("gesturestart",this,false);g.addEventListener("gestureend",this,false);g.addEventListener("touchmove",this,false);g.addEventListener("touchend",this,false);this.element[0].addEventListener("click",this,false);this.decayOff();this.element.trigger("lectric.start")};e.prototype.touchmove=function(a){if(this.gesturing)return false;
if(!this.moved){Math.abs(a.touches[0].pageY-this.startY)<15&&a.preventDefault();this.element.trigger("lectric.firstMove")}this.moved=true;this.lastX=this.currentX;this.lastMoveTime=new Date;this.currentX=this.limitXBounds(a.touches[0].pageX-this.startX);this.update()};e.prototype.touchend=function(){g.removeEventListener("gesturestart",this,false);g.removeEventListener("gestureend",this,false);g.removeEventListener("touchmove",this,false);g.removeEventListener("touchend",this,false);if(this.moved){this.currentX=
this.nearestPageX(this.limitXBounds(this.currentX+(this.currentX-this.lastX)*100/(new Date-this.lastMoveTime+1)));this.update();this.element.trigger("lectric.end")}else this.element.trigger("lectric.endNoMove");this.currentTarget=undefined};e.prototype.webkitTransitionEnd=function(){this.element.trigger("lectric.animationEnd")};e.prototype.gesturestart=function(){this.gesturing=true};e.prototype.gestureend=function(){this.gesturing=false};e.prototype.decayOff=function(){this.element.css({"-webkit-transition-duration":"0s"});
this.element.css({"-webkit-transition-property":"none"})};e.prototype.decayOn=function(){this.element.css({"-webkit-transition-duration":"0.4s"});this.element.css({"-webkit-transition-property":"-webkit-transform"})};h.Slider=d;h.TouchSlider=e;g.Lectric=h})(window);
